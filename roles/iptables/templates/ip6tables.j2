#########################################################################
####     AUTO GENERATED by Ansible, DO NOT EDIT                      ####
#########################################################################

*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]

:LogDrop -
:LogDropFwd -
:LogAccept -
:LogAcceptFwd -

-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT

## SSH from anywhere to any local interface
-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j LogAccept

-A INPUT -j LogDrop

-A FORWARD -j LogDrop


-A LogDrop -m limit --limit 10/second --limit-burst 20 -j LOG --log-level 4 --log-prefix "DROP_INPUT"
-A LogDrop -j DROP
-A LogDropFwd -m limit --limit 10/second --limit-burst 20 -j LOG --log-level 4 --log-prefix "DROP_FORWARD"
-A LogDropFwd -j DROP
-A LogAccept -m limit --limit 10/second --limit-burst 20 -j LOG --log-level 4 --log-prefix "ACCEPT_INPUT"
-A LogAccept -j ACCEPT
-A LogAcceptFwd -m limit --limit 10/second --limit-burst 20 -j LOG --log-level 4 --log-prefix "ACCEPT_FORWARD"
-A LogAcceptFwd -j ACCEPT

COMMIT
